shell: bash
commands:
  install:
    description: Install all the packages' dependencies
    cmd:
      yarn --cwd ./client &&
      mvn -f ./server/pom.xml
  build-proto:
    description: Generate TS typings from .proto definitions
    cmd:
      cp -r ./yearbook_production/** ./client/dist/yearbook_production-definitions &&
      protoc --plugin=./client/node_modules/.bin/protoc-gen-ts_proto --ts_proto_out=../yearbook_production-generated ./simple.proto
  build:
    description: Build all the packages
    cmd:
    depends:
      - build-yearbook_production
  parser:
    description: Up site parser service
    cmd: |
      docker-compose -f docker-compose-dev.yml up parser
      docker-compose -f docker-compose-dev.yml down
  run:
    description: Activate the whole service ecosystem
    cmd: |
      docker-compose -f docker-compose-dev.yml up parser-auchan parser-aquamarket parser-fozzy api
      docker-compose -f docker-compose-dev.yml down
